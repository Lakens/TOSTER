% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/perm_t_test.R
\name{perm_t_test}
\alias{perm_t_test}
\alias{perm_t_test.default}
\alias{perm_t_test.formula}
\title{Permutation t-test}
\usage{
perm_t_test(x, ...)

\method{perm_t_test}{default}(
  x,
  y = NULL,
  alternative = c("two.sided", "less", "greater", "equivalence", "minimal.effect"),
  mu = 0,
  paired = FALSE,
  var.equal = FALSE,
  alpha = 0.05,
  tr = 0,
  R = NULL,
  symmetric = TRUE,
  keep_perm = TRUE,
  ...
)

\method{perm_t_test}{formula}(formula, data, subset, na.action, ...)
}
\arguments{
\item{x}{a (non-empty) numeric vector of data values.}

\item{...}{further arguments (currently ignored).}

\item{y}{an optional (non-empty) numeric vector of data values.}

\item{alternative}{the alternative hypothesis:
- "two.sided": different from mu (default)
- "less": less than mu
- "greater": greater than mu
- "equivalence": between specified bounds
- "minimal.effect": outside specified bounds}

\item{mu}{a number or vector specifying the null hypothesis value(s):
* For standard alternatives: for standard alternatives (two.sided, less, greater): a single value (default: 0
* For equivalence/minimal.effect: either a single value (symmetric bounds will be created) or a vector of two values representing the lower and upper bounds}

\item{paired}{a logical indicating whether you want a paired t-test.}

\item{var.equal}{a logical variable indicating whether to treat the two variances as being equal.
If \code{TRUE} then the pooled variance is used to estimate the variance otherwise the Welch
(or Satterthwaite) approximation to the degrees of freedom is used. Default is \code{FALSE}.}

\item{alpha}{significance level (default = 0.05).}

\item{tr}{the fraction (0 to 0.5) of observations to be trimmed from each end before
computing the mean and winsorized variance. Default is 0 (no trimming).
When tr > 0, the function performs Yuen's trimmed t-test.}

\item{R}{the number of permutations. Default is NULL, which computes all exact permutations.
If R is specified and is less than the maximum number of possible permutations,
Monte Carlo sampling is used instead.}

\item{symmetric}{a logical variable indicating whether to assume symmetry in the two-sided test.
If \code{TRUE} (default) then the symmetric permutation p-value is computed, otherwise the
equal-tail permutation p-value is computed. Only relevant for \code{alternative = "two.sided"}.}

\item{keep_perm}{logical. If \code{TRUE} (default), the permutation distribution of the test
statistic and effect sizes are stored in the output. Set to \code{FALSE} for large datasets
to save memory.}

\item{formula}{a formula of the form lhs ~ rhs where lhs is a numeric variable giving the data values and rhs either 1 for a one-sample or paired test or a factor with two levels giving the corresponding groups. If lhs is of class "Pair" and rhs is 1, a paired test is done.}

\item{data}{an optional matrix or data frame (or similar: see model.frame) containing the variables in the formula formula. By default the variables are taken from environment(formula).}

\item{subset}{an optional vector specifying a subset of observations to be used.}

\item{na.action}{a function which indicates what should happen when the data contain NAs. Defaults to getOption("na.action").}
}
\value{
A list with class \code{"htest"} containing the following components:
\itemize{
\item "statistic": the value of the t-statistic.
\item "parameter": the degrees of freedom for the t-statistic.
\item "p.value": the permutation p-value for the test.
\item "stderr": the standard error of the mean (difference).
\item "conf.int": a permutation percentile confidence interval appropriate to the
specified alternative hypothesis.
\item "estimate": the estimated mean or difference in means (or trimmed means if tr > 0).
\item "null.value": the specified hypothesized value(s) of the mean or mean difference.
\item "alternative": a character string describing the alternative hypothesis.
\item "method": a character string indicating what type of permutation t-test was performed.
\item "data.name": a character string giving the name(s) of the data.
\item "call": the matched call.
\item "R": the requested number of permutations.
\item "R.used": the actual number of permutations used (may differ if exact permutations computed).
\item "perm.stat": (if keep_perm = TRUE) the permutation distribution of the test statistic.
\item "perm.eff": (if keep_perm = TRUE) the permutation distribution of the effect (mean differences).
}
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#maturing}{\figure{lifecycle-maturing.svg}{options: alt='[Maturing]'}}}{\strong{[Maturing]}}

Performs t-tests with permutation-based p-values and confidence intervals. This function supports
standard hypothesis testing alternatives as well as equivalence and minimal effect testing,
with optional trimmed means (Yuen's approach) for robust inference.
It can handle one-sample, two-sample (independent), and paired designs.
}
\details{
This function performs permutation-based t-tests, providing more robust inference than standard
parametric t-tests. It supports one-sample, two-sample (independent), and paired designs,
as well as five different alternative hypotheses.

The permutation procedure follows these steps:
\itemize{
\item Calculate the test statistic from the original data
\item Generate R permutation samples by randomly reassigning observations to groups
\item Calculate the test statistic for each permutation sample
\item Compute the p-value by comparing the original test statistic to the permutation distribution
\item Calculate confidence intervals using the percentile method
}

For one-sample and paired tests, permutation is performed by randomly flipping the signs of
the (centered) observations or difference scores.

For two-sample tests, permutation is performed by randomly reassigning observations to the
two groups. The studentized permutation approach of Janssen (1997) and Chung & Romano (2013)
is used, which is valid even under heteroscedasticity.

When \code{tr > 0}, the function uses Yuen's trimmed t-test approach:
\itemize{
\item Trimmed means are computed by removing the fraction \code{tr} of observations from each tail
\item Winsorized variances are used in place of standard variances
\item This provides robustness against outliers and heavy-tailed distributions
}

For different alternatives, the p-values are calculated as follows:
\itemize{
\item "two.sided": Either symmetric (proportion of |T\*| >= |T|) or equal-tail
(2 * min of one-sided p-values) depending on the \code{symmetric} argument
\item "less": Proportion of T\* <= T
\item "greater": Proportion of T\* >= T
\item "equivalence": Maximum of two one-sided p-values (for lower and upper bounds)
\item "minimal.effect": Minimum of two one-sided p-values (for lower and upper bounds)
}

For two-sample tests, the test is of \eqn{\bar x - \bar y} (mean of x minus mean of y).
For paired samples, the test is of the difference scores (z),
wherein \eqn{z = x - y}, and the test is of \eqn{\bar z} (mean of the difference scores).
For one-sample tests, the test is of \eqn{\bar x} (mean of x).

If the number of possible permutations is less than R, all exact permutations are computed
and a message is printed to the console.
}
\section{Purpose}{

Use this function when:
\itemize{
\item You need more robust inference than provided by standard t-tests
\item You want to perform equivalence or minimal effect testing with permutation methods
\item Sample sizes are very small where standard or bootstrap approaches may be less reliable
\item You prefer the standard \code{htest} output format for compatibility with other R functions
\item You want an alternative that tests means, mean difference, or difference in means that can also utilize trimming
}
}

\examples{

# Example 1: Basic two-sample test with formula notation
data(sleep)
result <- perm_t_test(extra ~ group, data = sleep)
result

# Example 2: One-sample permutation t-test
set.seed(123)
x <- rnorm(20, mean = 0.5, sd = 1)
perm_t_test(x, mu = 0, R = 199)

# Example 3: Paired samples test
before <- c(5.1, 4.8, 6.2, 5.7, 6.0, 5.5, 4.9, 5.8)
after <- c(5.6, 5.2, 6.7, 6.1, 6.5, 5.8, 5.3, 6.2)
perm_t_test(x = before, y = after,
            paired = TRUE,
            alternative = "less",
            R = 199)

# Example 4: Equivalence testing with permutation t-test
data(mtcars)
perm_t_test(mpg ~ am, data = mtcars,
            alternative = "equivalence",
            mu = c(-3, 3),
            R = 199)

# Example 5: Trimmed permutation t-test (Yuen's approach)
# Useful when data may contain outliers
set.seed(42)
x <- c(rnorm(18), 10, 15)  # Two outliers
y <- rnorm(20)
perm_t_test(x, y, tr = 0.1, R = 999)

# Example 6: Minimal effect testing
perm_t_test(mpg ~ am, data = mtcars,
            alternative = "minimal.effect",
            mu = c(-3, 3),
            R = 199)

}
\references{
Efron, B., & Tibshirani, R. J. (1993). An Introduction to the Bootstrap. Chapman and Hall/CRC.

Janssen, A. (1997). Studentized permutation tests for non-i.i.d. hypotheses and the
generalized Behrens-Fisher problem. Statistics & Probability Letters, 36, 9-21.

Chung, E., & Romano, J. P. (2013). Exact and asymptotically robust permutation tests.
The Annals of Statistics, 41(2), 484-507.

Yuen, K. K. (1974). The two-sample trimmed t for unequal population variances.
Biometrika, 61(1), 165-170.
}
\seealso{
Other Robust tests: 
\code{\link{boot_log_TOST}()},
\code{\link{boot_t_TOST}()},
\code{\link{boot_t_test}()},
\code{\link{brunner_munzel}()},
\code{\link{log_TOST}()},
\code{\link{wilcox_TOST}()}
}
\concept{Robust tests}
