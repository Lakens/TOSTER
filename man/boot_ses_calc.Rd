% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/boot_ses_calc.R
\name{boot_ses_calc}
\alias{boot_ses_calc}
\alias{boot_ses_calc.default}
\alias{boot_ses_calc.formula}
\title{Bootstrapped Standardized Effect Size (SES) Calculation}
\usage{
boot_ses_calc(
  x,
  ...,
  paired = FALSE,
  ses = "rb",
  alpha = 0.05,
  mu = 0,
  boot_ci = c("basic", "stud", "perc"),
  R = 1999,
  se_method = c("agresti", "fisher"),
  output = c("htest", "data.frame"),
  alternative = c("none", "two.sided", "less", "greater", "equivalence",
    "minimal.effect"),
  null.value = NULL
)

\method{boot_ses_calc}{default}(
  x,
  y = NULL,
  paired = FALSE,
  ses = c("rb", "odds", "logodds", "cstat"),
  alpha = 0.05,
  mu = 0,
  boot_ci = c("basic", "stud", "perc"),
  R = 1999,
  se_method = c("agresti", "fisher"),
  output = c("htest", "data.frame"),
  alternative = c("none", "two.sided", "less", "greater", "equivalence",
    "minimal.effect"),
  null.value = NULL,
  ...
)

\method{boot_ses_calc}{formula}(formula, data, subset, na.action, ...)
}
\arguments{
\item{x}{a (non-empty) numeric vector of data values.}

\item{...}{further arguments to be passed to or from methods.}

\item{paired}{a logical indicating whether you want a paired t-test. Cannot be used with the formula method; use x and y vectors instead for paired tests.}

\item{ses}{a character string specifying the effect size measure to calculate:
- "rb": rank-biserial correlation (default)
- "odds": Wilcoxon-Mann-Whitney odds
- "logodds": Wilcoxon-Mann-Whitney log-odds
- "cstat": concordance statistic (C-statistic/AUC)}

\item{alpha}{alpha level (default = 0.05)}

\item{mu}{number indicating the value around which asymmetry (for one-sample or paired samples)
or shift (for independent samples) is to be estimated (default = 0).}

\item{boot_ci}{method for bootstrap confidence interval calculation: "stud" (studentized, default), "basic" (basic bootstrap), or "perc" (percentile bootstrap).}

\item{R}{number of bootstrap replications (default = 1999).}

\item{se_method}{a character string specifying the method for computing standard errors
within each bootstrap sample:
- "agresti": (default) Uses the Agresti/Lehmann placement-based variance estimation.
This method has better asymptotic properties.
- "fisher": Uses the legacy Fisher z-transformation method. Retained for backward
compatibility.}

\item{output}{a character string specifying the output format:
- "htest": (default) Returns an object of class "htest" compatible with standard R output.
- "data.frame": Returns a data frame with effect size estimates and confidence intervals.}

\item{alternative}{a character string specifying the alternative hypothesis for optional
hypothesis testing:
- "none": (default) No hypothesis test is performed; only effect size and CI are returned.
- "two.sided": Test whether effect differs from null.value
- "less": Test whether effect is less than null.value
- "greater": Test whether effect is greater than null.value
- "equivalence": Test whether effect is between specified bounds
- "minimal.effect": Test whether effect is outside specified bounds}

\item{null.value}{a number or vector specifying the null hypothesis value(s):
- For standard alternatives: a single value (default = 0 for rb/logodds, 0.5 for cstat, 1 for odds)
- For equivalence/minimal.effect: two values representing the lower and upper bounds}

\item{y}{an optional (non-empty) numeric vector of data values.}

\item{formula}{a formula of the form lhs ~ rhs where lhs is a numeric variable giving the data values and rhs either 1 for a one-sample test or a factor with two levels giving the corresponding groups. For paired tests, use the default method with x and y vectors instead of the formula method.}

\item{data}{an optional matrix or data frame (or similar: see model.frame) containing the variables in the formula formula. By default the variables are taken from environment(formula).}

\item{subset}{an optional vector specifying a subset of observations to be used.}

\item{na.action}{a function which indicates what should happen when the data contain NAs. Defaults to getOption("na.action").}
}
\value{
If \code{output = "htest"} (default), returns a list with class \code{"htest"} containing:
\itemize{
\item estimate: The effect size estimate calculated from the original data
\item stderr: Standard error estimated from the bootstrap distribution
\item conf.int: Bootstrap confidence interval with conf.level attribute
\item alternative: A character string describing the alternative hypothesis
\item method: A character string indicating what type of test was performed
\item boot: The bootstrap samples of the effect size (on the requested scale)
\item data.name: A character string giving the name(s) of the data
\item call: The matched call
\item statistic: Test statistic (only if alternative != "none")
\item p.value: The bootstrapped p-value for the test (only if alternative != "none")
\item null.value: The specified hypothesized value(s) (only if alternative != "none")
}

If \code{output = "data.frame"}, returns a data frame containing:
\itemize{
\item estimate: The effect size estimate
\item SE: Standard error from the bootstrap distribution
\item lower.ci: Lower bound of the bootstrap confidence interval
\item upper.ci: Upper bound of the bootstrap confidence interval
\item conf.level: Confidence level (1-alpha or 1-2*alpha for equivalence)
\item boot_ci: The bootstrap CI method used
}
}
\description{
\ifelse{html}{\href{https://lifecycle.r-lib.org/articles/stages.html#maturing}{\figure{lifecycle-maturing.svg}{options: alt='[Maturing]'}}}{\strong{[Maturing]}}

Calculates non-SMD standardized effect sizes with bootstrap confidence intervals and
optional hypothesis testing. This function provides robust confidence intervals for
rank-based and probability-based effect size measures through resampling methods.
}
\details{
This function calculates bootstrapped confidence intervals for rank-based and probability-based
effect size measures. It extends the \code{ses_calc()} function by using resampling
to provide more robust confidence intervals, especially for small sample sizes.

The function implements the following bootstrap approach:
\itemize{
\item Calculate the raw effect size using the original data
\item Create R bootstrap samples by resampling with replacement from the original data
\item Calculate the effect size for each bootstrap sample
\item Apply the Fisher z-transformation to stabilize variance for rank-biserial correlation values
\item Calculate confidence intervals using the specified method
\item Back-transform the confidence intervals to the original scale
\item Convert to the requested effect size measure (if not rank-biserial)
}
\subsection{Standard Error Methods}{

Two methods are available for computing standard errors within each bootstrap sample:
\itemize{
\item \strong{Agresti method} (\code{se_method = "agresti"}): Uses the Agresti/Lehmann placement-based
variance estimation. This method computes the variance of the concordance probability
and propagates it to other effect size scales using the delta method.
\item \strong{Fisher method} (\code{se_method = "fisher"}): Uses the legacy formula based on the
Wilcoxon statistic variance. This is retained for backward compatibility.
}
}

\subsection{Bootstrap Confidence Interval Methods}{

Three bootstrap confidence interval methods are available:
\itemize{
\item \strong{Basic bootstrap ("basic")}: Uses the empirical distribution of bootstrap estimates
\item \strong{Studentized bootstrap ("stud")}: Accounts for the variability in standard error estimates
\item \strong{Percentile bootstrap ("perc")}: Uses percentiles of the bootstrap distribution directly
}
}

\subsection{Hypothesis Testing}{

When an alternative other than "two.sided" is specified, or when null.value is not the
default, the function performs bootstrap hypothesis testing. For equivalence and minimal
effect testing, specify null.value as a vector of two values (lower and upper bounds).

For different alternatives, the p-values are calculated as follows:
\itemize{
\item "two.sided": Proportion of bootstrap statistics at least as extreme as the observed statistic
\item "less": Proportion of bootstrap statistics less than or equal to the observed statistic
\item "greater": Proportion of bootstrap statistics greater than or equal to the observed statistic
\item "equivalence": Maximum of two one-sided p-values (for lower and upper bounds)
\item "minimal.effect": Minimum of two one-sided p-values (for lower and upper bounds)
}

The function supports three study designs:
\itemize{
\item One-sample design: Compares a single sample to a specified value
\item Two-sample independent design: Compares two independent groups
\item Paired samples design: Compares paired observations
}

Note that extreme values (perfect separation between groups) can produce infinite values during
the bootstrapping process. The function will issue a warning if this occurs.

For detailed information on calculation methods, see \code{vignette("robustTOST")}.
}
}
\section{Purpose}{

Use this function when:
\itemize{
\item You need more robust confidence intervals for non-parametric effect sizes
\item You prefer resampling-based confidence intervals over asymptotic approximations
\item You need to quantify uncertainty in rank-based effect sizes more accurately
\item You want to perform hypothesis testing with bootstrap methods
}
}

\examples{
# Example 1: Independent groups comparison with basic bootstrap CI
set.seed(123)
group1 <- c(1.2, 2.3, 3.1, 4.6, 5.2, 6.7)
group2 <- c(3.5, 4.8, 5.6, 6.9, 7.2, 8.5)

# Use fewer bootstrap replicates for a quick example
result <- boot_ses_calc(x = group1, y = group2,
                        ses = "rb",
                        boot_ci = "basic",
                        R = 99)

# Example 2: Hypothesis testing (two-sided)
result <- boot_ses_calc(x = group1, y = group2,
                        ses = "rb",
                        alternative = "two.sided",
                        null.value = 0,
                        R = 99)

# Example 3: Equivalence testing
result <- boot_ses_calc(x = group1, y = group2,
                        ses = "rb",
                        alternative = "equivalence",
                        null.value = c(-0.3, 0.3),
                        R = 99)

# Example 4: Paired samples
data(sleep)
with(sleep, boot_ses_calc(x = extra[group == 1],
                          y = extra[group == 2],
                          paired = TRUE,
                          ses = "rb",
                          alternative = "greater",
                          R = 99))

# Example 5: Using formula notation
data(mtcars)
result <- boot_ses_calc(formula = mpg ~ am,
                        data = mtcars,
                        ses = "cstat",
                        boot_ci = "perc",
                        R = 99)

}
\references{
Agresti, A. (1980). Generalized odds ratios for ordinal data. \emph{Biometrics}, 36, 59-67.

Bamber, D. (1975). The area above the ordinal dominance graph and the area below the receiver
operating characteristic graph. \emph{Journal of Mathematical Psychology}, 12, 387-415.

Efron, B., & Tibshirani, R. J. (1994). An introduction to the bootstrap. CRC press.

Lehmann, E.L. (1975). \emph{Nonparametrics: Statistical Methods Based on Ranks}. Holden-Day.
}
\seealso{
Other effect sizes: 
\code{\link{boot_smd_calc}()},
\code{\link{ses_calc}()},
\code{\link{smd_calc}()}
}
\concept{effect sizes}
